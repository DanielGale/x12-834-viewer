<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>X12 834 Tree Viewer</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    textarea { width: 100%; height: 150px; font-family: monospace; }
    button { margin-top: 10px; }
    .segment { margin: 4px 0; padding: 8px; border-radius: 6px; }
    .INS { background-color: #d0f0fd; }
    .REF { background-color: #e0ffe0; }
    .NM1 { background-color: #fff3cd; }
    .PER { background-color: #fce4ec; }
    .DTP { background-color: #f0e68c; }
    .N3, .N4 { background-color: #e8eaf6; }
    .HD  { background-color: #ffebee; }
    .default { background-color: #f9f9f9; }

    details summary {
      cursor: pointer;
      font-weight: bold;
      padding: 4px;
    }

    .element {
      margin-left: 16px;
      font-family: monospace;
    }
  </style>
</head>
<body>
  <h2>X12 834 Tree Viewer</h2>
  <p>Paste your 834 file contents below:</p>
  <textarea id="x12input"></textarea><br>
  <button onclick="parseX12()">Parse File</button>
  <div id="output"></div>

  <script>
    function parseX12() {
      const raw = document.getElementById("x12input").value.trim();
      const segmentDelimiter = "~";
      const elementDelimiter = "*";
      const segments = raw.split(segmentDelimiter).filter(Boolean);
      const output = document.getElementById("output");
      output.innerHTML = "";

      segments.forEach(segment => {
        const elements = segment.trim().split(elementDelimiter);
        const segmentId = elements[0];
        const colorClass = [
          "INS", "REF", "NM1", "PER", "DTP", "N3", "N4", "HD"
        ].includes(segmentId) ? segmentId : "default";

        const wrapper = document.createElement("details");
        wrapper.className = `segment ${colorClass}`;
        const summary = document.createElement("summary");
        summary.textContent = `${segmentId} (${elements.length - 1} elements)`;
        wrapper.appendChild(summary);

        elements.slice(1).forEach((e, i) => {
          const div = document.createElement("div");
          div.className = "element";
          div.textContent = `Element ${i + 1}: ${e}`;
          wrapper.appendChild(div);
        });

        output.appendChild(wrapper);
      });
    }
  </script>
</body>
</html>
